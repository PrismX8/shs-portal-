<!DOCTYPE html>
<html>

<head>
    <title>Bowmasters</title>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="mobile-web-app-capable" content="yes"/>
    <meta name="apple-touch-fullscreen" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="msapplication-tap-highlight" content="no"/>
    <meta name="MobileOptimized" content="960"/>
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0, user-scalable=no, minimal-ui"/>
    <meta charset="utf-8"/>

    <link rel="stylesheet" type="text/css" href="style/index.css" nonce="nDK4DWRLJoqf7mjw9cLs1g"/>

    <script src="ytgame.js" nonce="nDK4DWRLJoqf7mjw9cLs1g"></script>
    <script src="game.js" nonce="nDK4DWRLJoqf7mjw9cLs1g"></script>
    <script src="https://funfrinew.neocities.org/games/Bowmasters/particles.js" nonce="nDK4DWRLJoqf7mjw9cLs1g"></script>

    <style>
        html, body {
            width: 100vw;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            background-color: black; /* Prevents flash of white background */
        }
        #game {
            position: absolute;
            width: 100%;
            height: 100%;
        }
    </style>

    <script nonce="nDK4DWRLJoqf7mjw9cLs1g">
        (function() {
            try {
                // Bypass iframe detection
                Object.defineProperty(window, "top", { get: () => window.self });
                Object.defineProperty(window, "parent", { get: () => window.self });

                // Prevent frame busting
                window.open = function() { return null; };

                console.log("Iframe detection overridden successfully.");
            } catch (e) {
                console.warn("Failed to override iframe detection.");
            }

            document.addEventListener("DOMContentLoaded", function() {
                console.log("DOM fully loaded. Initializing game...");

                // Ensure game container exists
                let gameContainer = document.getElementById("game");
                if (!gameContainer) {
                    console.error("Game container (#game) not found.");
                    return;
                }

                // Force game to take full screen
                document.documentElement.style.width = "100vw";
                document.documentElement.style.height = "100vh";
                document.body.style.width = "100vw";
                document.body.style.height = "100vh";
                document.body.style.overflow = "hidden";

                gameContainer.style.position = "absolute";
                gameContainer.style.width = "100%";
                gameContainer.style.height = "100%";

                // Fix particles.js error by ensuring elements exist before running
                setTimeout(() => {
                    if (typeof window.runGame === "function") {
                        console.log("Starting game...");
                        window.runGame();
                    } else {
                        console.error("Game function not found.");
                    }
                }, 500);
            });
        })();
    </script>
</head>

<body>
    <div id="game"></div>
</body>

</html>